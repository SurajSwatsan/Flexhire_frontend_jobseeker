
<div class="container">
<div class="form-wrapper">

<div class="p-fluid">
  <h2>Forgot Password</h2>
  <form (ngSubmit)="onSubmit()">
    
    <form [formGroup]="forgotPasswordForm" (ngSubmit)="sendOtp()">
      <div class="p-field">
        <label for="emailOrMobile">Email or Mobile Number</label>
        <input id="emailOrMobile" type="text" pInputText formControlName="emailOrMobile" />
        <div *ngIf="forgotPasswordForm.get('emailOrMobile')?.invalid && 
                     (forgotPasswordForm.get('emailOrMobile')?.dirty || 
                      forgotPasswordForm.get('emailOrMobile')?.touched)">
          <small *ngIf="forgotPasswordForm.get('emailOrMobile')?.errors?.['required']">Email or Mobile Number is required.</small>
          <small *ngIf="forgotPasswordForm.get('emailOrMobile')?.errors?.['pattern']">Invalid email or mobile number format.</small>
        </div>
      </div>
    
      <button pButton type="submit" label="Send OTP"></button>
    </form>
    
    
      <div *ngIf="otpSent">
        <form [formGroup]="forgotPasswordForm" (ngSubmit)="verifyOtp()">
          <div class="p-field">
            <label for="otp">OTP</label>
            <input id="otp" type="text" pInputText formControlName="otp" />
            <button pButton type="submit">Verify OTP</button>
    
            <div *ngIf="forgotPasswordForm.get('otp')?.invalid && 
                         (forgotPasswordForm.get('otp')?.dirty || 
                          forgotPasswordForm.get('otp')?.touched)">
              <small *ngIf="forgotPasswordForm.get('otp')?.errors?.['required']">OTP is required.</small>
              <small *ngIf="forgotPasswordForm.get('otp')?.errors?.['pattern']">OTP must be numeric only.</small>
            </div>
            
            <div *ngIf="timerActive">
              <p>Resend OTP in: {{ countdown }} seconds</p>
            </div>
            
            <span *ngIf="!timerActive" 
              class="resend-otp" 
              (click)="resendOtp()" 
              pRipple>
              Resend OTP
            </span>
          </div>
        </form>
    
        <div *ngIf="otpVerified">
          <form [formGroup]="forgotPasswordForm" (ngSubmit)="resetPassword()">
            <div class="p-field">
              <label for="password">New Password</label>
              <input id="password" type="password" pInputText formControlName="password" />
              <div *ngIf="forgotPasswordForm.get('password')?.invalid && 
                           (forgotPasswordForm.get('password')?.dirty || 
                            forgotPasswordForm.get('password')?.touched)">
                <small *ngIf="forgotPasswordForm.get('password')?.errors?.['required']">Password is required.</small>
                <small *ngIf="forgotPasswordForm.get('password')?.errors?.['minlength']">
                  Password must be at least 6 characters long.
                </small>
              </div>
            </div>
            
            <div class="p-field">
              <label for="confirmPassword">Confirm Password</label>
              <input id="confirmPassword" type="password" pInputText formControlName="confirmPassword" />
              <div *ngIf="forgotPasswordForm.get('confirmPassword')?.invalid && 
                           (forgotPasswordForm.get('confirmPassword')?.dirty || 
                            forgotPasswordForm.get('confirmPassword')?.touched)">
                <small *ngIf="forgotPasswordForm.get('confirmPassword')?.errors?.['required']">Confirmation is required.</small>
                <small *ngIf="forgotPasswordForm.errors?.['passwordMismatch'] && forgotPasswordForm.get('confirmPassword')?.touched">Passwords do not match.</small>
              </div>
            </div>
            
            <button pButton type="submit" label="Reset Password"></button>
          </form>
        </div>
      </div>
      </form>
     </div>
    </div>
  </div>
  